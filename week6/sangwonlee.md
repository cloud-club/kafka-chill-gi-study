### 7.1 신뢰성 보장

- 카프카는 다음과 같은 **신뢰성 보장**을 제공:
- 신뢰성은 절충 가능하기는 하지만 어떤 의미를 가지는 지 먼저 알아보고 넘어가자
    1. **메시지 순서 보장**: 동일한 프로듀서가 동일 파티션에 쓴 메시지는 순서를 유지.
    2. **커밋된 메시지 보존**: 인-싱크 레플리카에 저장된 후에야 커밋으로 간주 최소 하나의 레플리카가 살아 있는 한 유실되지 않음.
    3. **커밋된 메시지 소비**: 컨슈머는 커밋된 메시지만 읽음.
이런 신뢰성은 트레이드 오프가 있고 이러한 트레이드 오프는
신뢰성이냐 일관성이냐 가용성이냐 높은 처리량, 낮은 지연 하드웨어 비용이 대표적일 수 있다.

### 7.2 복제

- 카프카는 복제를 통해 **데이터 지속성**과 **고가용성**을 보장.
- **인-싱크 레플리카**: 이것을 통해 장애가 나면 인싱크 레플리카 중 리더를 또 선출함
    - 조건:
        1. Zookeeper와의 세션이 유지됨(기본 6초).
        2. 최근 10초 이내에 리더 레플리카와 동기화.
        3. 최신 메시지를 복제 완료.
    - 복제 지연 발생 시 **아웃-오브-싱크 레플리카**로 간주되어 신뢰성 저하.

### **7.3 브로커 설정**

작동을 변경 시키는 브로커 설저 매개변수 3개

- **복제 팩터**:
    - 기본값 3 <- 물론 바꿀 수 있음
    - 높은 복제 팩터 → 가용성과 신뢰성 증가, 디스크 사용량 처리량(종단지연) 증가.
    - 설정:
        - `replication.factor` (토픽 단위)
        - `default.replication.factor` (브로커 단위)
- **언클린 리더 선출**:
    - 리더 설정을 다시하는 것을 클린하다고 함
    - 설정: `unclean.leader.election.enable=false` (기본값).
    - 아웃-오브-싱크 레플리카를 리더로 선출하지 않아 데이터 유실 방지.
      
- **최소 인-싱크 레플리카**:
    - 설정: `min.insync.replicas`.
    - 설정 값 이하의 레플리카만 동기화되면 쓰기 불가(데이터 유실 방지).
    - 예외: `NotEnoughReplicasException`.
      

아직 다 못 읽어서 읽고 이해한대까지만 기재했습니다 ㅜㅜ
